= Spring AI application with Spring Data Neo4j

This is an example application using Spring AI, Spring Data Neo4j, Neo4j (utilizing both vector search and graph search capabilities), and Goodreads book data.

== Data set

Data is maintained and pulled from a public data source. Load scripts and more information is available in https://github.com/JMHReif/graph-demo-datasets/tree/main/goodreadsUCSD[this data set Github repository^]. An example of the data model is shown below.

image::src/main/resources/goodreads-data-model.png[]

For this project, we are focusing on the Book and Review entities and the relationship between them.

== Notes

There were a few "gotchas" I found as I built this application.

1. Spring AI with Neo4j uses a default vector index name of `spring-ai-document-index` and default entity type of `Document`. You can customize these with a custom `Neo4jVectorStore` bean or with configuration properties (`application.properties` file).
2. Spring AI requires property names of `id` and `text` to return in the list of Documents from the similaritySearch method (no matter what label is configured for the Neo4jVectorStore bean). If your properties are named something else, the Spring app cannot map them from the Neo4j node to the expected Document object. You can refactor the data in Neo4j to change the property names to `id` and `text`.

== Running and testing this project

To run the application, you will need the following:

* Neo4j database credentials. You can set these in the `application.properties` file or as environment variables on the machine.
* OpenAI API key: they offer a free tier that works for this.

Once that's set up, execute the application with `./mvnw spring-boot:run`.

You can test a few different things. The `/graphTool` endpoint uses Neo4j as a tool by creating 2 access points - 1 for vector search and 1 for graph retrieval (based on vector search results). The output of the tools is sent to the LLM for a response. Here are some ideas for values to test the `/graph` endpoint:

```
http ":8080/graphTool?searchPhrase=happy%20ending"

http ":8080/graphTool?searchPhrase=encouragement"

http ":8080/graphTool?searchPhrase=dragons and magic"

http ":8080/graphTool?searchPhrase=high tech"

http ":8080/graphTool?searchPhrase=caffeine"
```

*Note:* The above commands are using the https://httpie.io/[
HTTPie^] command line tool, but you can use `curl` similarly.

== Presentation

PDF versions of accompanying presentations are published to SpeakerDeck.

== Resources
* Site: https://dev.neo4j.com/aura-java[Neo4j Aura^]
* Documentation: https://docs.spring.io/spring-ai/reference/api/vectordbs/neo4j.html[Spring AI Neo4j Vector Store^]
* Documentation: https://docs.spring.io/spring-ai/reference/api/tools.html[Spring AI Tools^]
* Online training: https://graphacademy.neo4j.com/categories/llms/[GraphAcademy LLM courses^]
* Documentation: https://platform.openai.com/docs/guides/embeddings[OpenAI Embeddings^]
